import {Injectable} from '@angular/core';

const WHITE_WINE_DATA = require('./wine/wine.quality.white.json');
const RED_WINE_DATA = require('./wine/wine.quality.red.json');


const whiteWine = {
  predict: `7 6 6 6 6 7 6 7 7 5 6 5 7 6 6 6 6 7 6 5 7 7 6 6 6 6 7 6 5 6 7 5 6 6 7 7 5 7 7 5 7 5 6 6 6 7 6 5 7 6 5 7 7 6 7 7 7 6 6 6 6 6 6 6 7 7 6 6 6 7 6 7 7 6 5 7 6 7 6 7 5 6 6 6 6 7 7 7 7 7 6 7 5 6 5 5 6 6 6 6 5 7 5 5 6 6 5 5 6 6 7 7 7 6 6 6 6 6 6 6 7 6 6 6 6 6 6 6 7 6 6 6 7 5 6 5 7 6 6 6 6 6 6 5 6 6 6 6 6 6 6 6 6 7 7 6 6 6 6 6 6 6 7 6 6 6 6 6 6 6 7 5 6 6 6 7 7 5 5 6 6 6 5 6 6 6 5 6 5 6 6 5 6 6 6 5 7 5 6 5 5 5 6 6 5 6 6 7 7 6 7 6 6 6 6 6 6 6 7 7 6 6 6 5 6 5 6 7 6 6 6 7 7 6 5 7 7 7 6 7 6 7 6 7 7 7 5 6 7 6 5 6 6 7 6 6 7 6 5 6 6 7 6 6 6 7 5 6 6 6 7 5 6 5 5 5 5 5 6 6 5 5 7 5 6 5 6 5 6 5 5 5 7 5 5 6 6 6 6 6 7 6 6 6 6 7 5 6 7 6 6 6 6 6 6 6 6 6 6 5 5 6 6 6 6 6 7 6 6 6 6 6 6 6 6 6 7 5 5 5 6 5 6 6 6 7 5 7 7 7 7 7 5 6 6 6 6 7 5 5 6 6 6 6 6 6 6 6 6 5 6 6 6 6 6 6 6 6 5 6 6 6 6 6 6 6 6 7 5 6 6 6 6 6 7 6 6 7 6 6 6 7 6 5 5 6 5 5 6 6 5 5 6 6 6 7 6 5 7 5 6 6 7 7 7 7 7 6 7 6 7 5 5 6 6 6 7 7 6 5 6 6 6 6 5 5 6 6 6 6 5 5 5 5 6 6 5 7 6 7 5 6 6 6 6 5 7 7 6 6 6 6 5 5 6 6 7 7 7 7 6 6 7 5 7 6 6 7 7 5 7 7 6 6 7 5 5 6 6 6 5 5 6 7 6 6 6 5 6 5 6 6 5 5 6 6 6 6 7 7 6 5 5 5 6 6 5 6 6 6 6 6 5 5 7 6 5 6 6 5 5 6 6 6 5 5 5 7 7 7 6 6 6 6 7 6 7 6 6 6 6 6 6 5 6 6 6 6 6 7 6 6 6 5 5 6 7 6 7 5 5 6 6 7 6 5 6 5 5 6 6 5 5 5 5 6 6 7 6 5 7 6 6 5 5 6 5 6 5 5 5 4 5 6 5 5 5 5 6 6 6 6 5 6 6 5 6 6 6 6 6 6 5 5 6 6 7 7 6 6 6 6 6 6 6 5 5 5 6 6 6 6 6 5 6 6 6 6 5 5 6 5 5 6 5 5 7 5 5 6 6 5 6 5 5 6 7 6 6 6 7 7 6 6 6 6 6 6 5 5 6 6 5 6 5 7 6 6 6 6 6 7 6 5 5 6 7 7 7 5 6 6 6 6 6 6 6 6 6 6 6 7 5 6 6 5 5 5 5 5 5 5 5 5 5 6 6 6 6 7 6 7 5 7 6 5 6 6 6 6 6 6 5 6 5 7 7 6 6 7 6 6 6 6 6 6 6 7 7 6 5 6 6 6 7 6 6 6 6 6 6 7 6 5 5 5 5 5 5 5 6 5 6 6 5 7 7 6 6 6 6 6 6 7 6 6 6 5 5 6 5 7 6 6 6 7 5 5 7 5 6 6 6 6 6 7 6 5 5 6 6 7 6 7 6 7 7 6 7 7 6 5 6 5 5 5 5 5 7 6 6 6 5 6 6 6 6 6 6 5 6 5 6 6 6 6 6 6 6 6 7 6 6 5 5 6 6 6 6 6 7 7 6 6 6 6 7 7 5 7 7 7 6 6 6 6 6 6 5 6 6 6 6 5 5 5 5 5 5 5 5 6 5 6 6 6 5 6 5 6 5 5 7 7 6 6 6 7 6 6 6 5 6 7 6 5 6 5 7 5 6 6 6 5 6 6 5 6 5 7 5 5 6 6 6 7 6 6 6 6 5 6 6 6 6 6 6 6 6 6 6 6 6 7 6 6 5 5 7 6 5 7 6 7 6 7 6 5 6 6 5 5 5 5 6 6 5 6 6 6 6 6 5 7 7 5 6 6 6 6 6 5 5 7 5 5 6 6 7 7 6 6 6 5 5 7 6 5 5 5 7 6 6 6 7 6 5 5 6 6 6 6 7 7 6 6 6 7 7 5 5 5 6 5 6 5 5 7 6 6 7 7 6 7 6 6 6 6 6 5 6 6 6 5 6 7 6 6 7 7 6 5 7 6 6 6 5 6 7 6 6 6 6 5 6 6 6 6 6 6 5 5 5 5 6 6 6 5 5 6 6 6 7 7 6 6 7 6 6 7 6 6 6 6 7 7 7 5 6 5 6 6 7 6 6 6 6 6 6 6 6 6 6 7 7 7 7 7 6 6 7 6 5 6 6 5 6 7 6 6 6 6 6 6 6 6 7 6 7 5 6 6 6 6 6 6 6 7 6 6 7 5 5 5 5 6 5 6 6 7 6 5 6 6 7 7 7 5 6 6 6 6 6 6 6 6 6 5 5 6 5 5 6 6 7 6 7 7 6 6 5 5 5 7 5 7 6 6 6 6 7 6 7 6 7 6 6 7 5 6 6 6 5 6 6 7 6 6 6 7 5 6 5 7 6 6 6 6 5 5 5 5 5 6 5 5 6 7 7 7 5 6 6 5 5 6 5 6 6 6 6 7 7 6 6 6 6 6 6 6 6 6 6 6 5 5 6 6 7 5 6 6 6 7 7 6 6 6 6 6 7 6 5 6 6 6 6 8 5 6 5 5 6 6 7 7 6 6 7 7 6 6 6 6 7 7 6 7 6 6 6 6 6 6 5 6 6 6 6 7 6 5 5 5 5 5 6 6 7 7 6 7 6 5 7 5 5 6 6 7 6 6 6 6 6 6 6 5 6 6 6 6 5 6 6 5 7 7 5 6 7 7 5 6 6 6 6 6 6 6 6 6 6 5 6 6 7 6 5 6 6 6 6 6 6 6 6 5 6 7 6 5 6 5 6 6 7 5 5 6 5 5 5 6 6 7 5 7 6 7 6 6 6 7 5 6 6 5 6 5 5 5 5 5 6 6 5 5 7 7 5 5 6 6 6 6 5 5 7 6`.split(' ').map(Number),
  quality: `6 5 6 6 5 7 6 6 6 5 5 5 5 5 7 6 5 8 6 6 7 8 7 7 5 6 5 6 5 7 7 6 6 8 6 7 5 6 6 5 8 6 8 6 6 8 6 6 8 7 6 7 8 5 8 7 8 7 6 6 6 8 7 6 7 7 6 7 7 6 6 7 7 6 5 7 7 7 6 7 5 6 6 7 6 6 6 7 7 7 5 7 5 7 5 5 6 6 6 6 4 7 5 5 6 6 5 5 6 5 7 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 7 6 6 4 6 5 6 5 6 6 6 6 7 6 6 4 6 6 6 7 5 7 4 7 5 7 6 6 7 7 7 6 6 6 7 5 7 7 7 7 7 6 7 6 6 7 6 7 6 5 5 6 6 6 5 6 6 6 5 6 5 5 7 6 7 7 6 6 7 5 5 5 6 6 6 6 6 6 7 6 7 7 7 6 6 6 6 6 7 6 7 7 5 6 4 6 6 6 6 7 7 8 7 8 8 6 4 6 8 8 7 8 5 7 6 7 8 7 5 6 7 6 5 7 6 8 7 6 7 6 5 5 6 8 7 6 7 7 5 6 7 6 6 5 5 5 6 6 6 6 6 6 5 5 5 6 5 5 4 6 5 6 5 5 7 5 5 7 6 6 7 7 7 5 6 6 5 6 5 6 4 5 6 7 7 7 7 7 7 7 5 6 5 6 7 5 5 5 8 6 5 5 5 6 6 7 5 5 8 5 5 5 6 5 4 6 6 5 5 6 5 6 7 7 5 6 6 5 6 7 5 5 5 6 5 5 6 6 5 6 6 5 5 5 5 6 5 6 5 6 5 5 6 6 3 5 5 5 5 7 5 6 6 6 5 6 6 5 7 6 6 5 6 7 7 5 5 6 5 5 6 6 5 5 6 6 6 7 6 5 6 5 6 5 6 7 6 7 6 6 6 6 6 5 5 6 6 6 7 6 6 5 6 6 6 6 4 5 5 7 5 5 5 4 6 6 5 6 6 6 6 6 6 6 6 5 5 5 6 6 6 6 7 5 5 4 6 6 7 7 7 7 7 7 6 6 7 6 7 7 6 5 7 6 6 5 7 5 5 5 6 5 5 5 6 6 8 4 6 5 6 5 6 6 5 5 6 6 6 6 6 7 5 5 5 5 6 7 5 6 5 5 6 6 6 5 7 7 5 4 6 4 6 6 7 6 6 4 6 7 7 6 7 6 5 7 7 6 7 6 6 6 6 6 6 5 7 7 7 5 7 7 6 6 6 5 6 6 7 6 6 5 6 6 6 7 6 6 6 5 5 6 6 5 4 5 5 6 6 6 6 5 6 6 5 5 5 6 5 6 5 5 5 4 5 5 7 7 7 7 7 6 6 6 7 6 5 7 7 6 5 6 6 6 5 5 6 5 5 8 6 5 6 6 5 6 7 5 4 6 5 6 6 6 6 6 6 5 8 6 6 6 6 6 6 6 6 6 7 6 5 6 5 6 6 5 5 7 7 7 5 6 6 6 5 6 6 6 6 6 6 6 8 7 5 6 6 6 7 5 5 5 5 7 6 5 5 6 6 5 6 5 6 7 6 6 6 6 6 6 7 7 6 7 5 6 6 5 5 5 5 7 7 7 7 7 7 5 5 7 7 8 6 7 7 5 6 5 6 7 6 6 7 5 6 6 6 7 7 5 5 6 6 5 6 5 6 6 6 8 6 5 5 6 6 6 6 5 6 6 6 7 6 6 6 6 4 4 5 5 5 4 6 5 6 6 4 4 7 5 7 7 6 6 6 6 6 6 6 5 5 5 5 7 6 6 7 6 5 5 6 6 6 6 6 6 6 4 5 5 5 5 6 6 6 7 6 6 6 6 7 7 6 5 6 5 6 6 6 6 7 5 4 6 6 5 5 6 6 6 6 5 6 6 5 5 6 5 5 5 6 6 6 6 5 5 6 6 6 6 6 7 6 6 6 5 6 6 7 7 5 7 7 7 5 6 7 6 6 5 5 5 5 5 5 5 8 8 8 8 8 8 8 8 8 6 6 6 6 6 6 7 6 5 6 6 5 6 6 6 5 6 5 6 5 6 6 5 6 5 6 5 6 6 5 5 6 6 5 6 5 6 5 5 6 6 6 6 5 5 6 6 6 4 5 5 5 6 6 5 5 5 5 5 5 6 6 5 5 5 7 6 5 7 5 7 7 7 7 5 5 6 6 6 6 6 6 6 6 6 6 5 6 6 5 6 6 5 6 6 6 6 5 5 5 6 5 5 6 6 6 6 5 6 6 5 5 6 6 5 5 5 7 5 6 6 6 6 5 5 5 5 6 6 6 6 5 5 6 6 6 5 5 5 5 5 6 4 5 6 6 6 6 6 6 6 6 6 6 6 6 5 5 6 6 6 6 7 5 5 6 5 4 5 6 6 6 6 5 6 6 6 6 6 5 5 6 5 6 6 6 6 6 6 6 6 6 5 6 6 6 5 6 5 6 6 5 5 6 6 6 6 5 5 6 6 6 6 6 5 5 6 6 7 6 6 7 7 7 5 5 5 6 6 6 7 7 6 7 7 5 6 7 6 6 6 6 6 6 6 6 6 5 6 6 6 6 6 6 6 6 6 6 7 6 6 6 6 6 6 5 6 7 4 6 5 5 5 5 7 5 7 7 5 6 7 7 6 6 5 6 6 6 7 7 7 6 6 6 6 5 6 5 6 6 6 7 6 6 7 7 7 5 5 5 7 5 7 7 7 7 7 6 6 6 5 6 7 7 6 5 7 7 5 6 5 5 7 7 6 6 7 6 5 4 6 6 6 6 5 4 6 6 6 6 7 5 6 7 7 6 7 6 5 5 6 6 7 6 6 7 6 6 6 7 6 6 6 7 6 6 6 6 6 5 6 6 6 6 6 6 6 6 5 5 6 6 6 6 6 6 7 6 6 5 6 6 5 5 3 6 6 5 6 5 6 7 6 6 6 7 7 6 6 6 6 7 7 6 8 8 7 6 6 6 6 5 7 4 6 6 6 6 4 5 5 6 6 5 7 8 8 5 6 6 6 6 6 5 7 7 6 5 6 7 7 8 7 4 6 6 6 5 6 5 6 7 5 6 7 6 6 6 6 5 6 6 7 5 6 6 6 5 7 6 6 5 6 7 6 5 6 6 4 7 6 6 5 6 5 6 7 6 5 6 5 5 5 6 6 6 6 5 6 6 6 6 7 5 6 6 6 6 6 7 6 5 6 6 6 7 5 4 6 6 6 5 6 5 6 7 7 5 6 6 6 5 6 5 6 7 6`.split(' ').map(Number),
  featureImportance: [
    ['alcohol', 14.248640775720522],
    ['sulphates', 11.807333669492225],
    ['volatile acidity', 11.628464563362554],
    ['density', 9.977932808322997],
    ['total sulfur dioxide', 8.9873792106371084],
    ['chlorides', 8.1545227444793458],
    ['free sulfur dioxide', 7.4739210280468011],
    ['pH', 7.4706910271544276],
    ['citric acid', 7.1382436523357535],
    ['fixed acidity', 6.9202030920748516],
    ['residual sugar', 6.1926674283733423],
  ],
  data: WHITE_WINE_DATA

};


const redWine = {
  predict: `6 7 6 6 6 6 6 7 6 5 6 6 5 7 6 6 6 6 6 5 5 5 6 6 6 6 6 6 7 6 6 7 6 5 6 6 5 6 7 6 6 6 6 6 5 5 5 6 6 6 6 6 6 6 5 5 6 5 6 5 6 6 6 6 5 5 6 7 6 5 5 7 5 7 5 5 5 5 5 6 5 5 6 6 5 6 6 6 5 6 6 6 5 6 6 6 6 5 6 6 6 6 6 5 7 6 5 5 5 7 5 7 5 5 6 6 7 5 6 5 6 5 5 7 5 5 6 5 6 6 6 6 5 5 5 6 6 5 5 6 6 5 5 5 5 6 6 6 7 5 7 7 6 6 5 6 5 7 5 5 6 6 6 6 5 6 6 7 6 5 5 6 6 6 5 6 5 5 6 6 4 6 6 6 6 5 5 5 6 5 5 5 7 5 5 5 5 7 6 5 5 5 6 6 6 6 6 6 6 5 5 5 5 5 5 5 6 5 5 5 6 6 6 6 6 6 6 6 5 5 6 5 6 5 5 5 5 5 6 5 6 6 5 6 5 6 5 5 5 5 5 5 7 5 5 5 5 5 6 5 6 6 5 5 5 5 5 5 5 5 5 6 5 5 5 5 5 5 5 5 6 5 5 6 6 5 6 6 6 6 6 6 6 6 5 6 6 6 6 5 5 5 5 6 6 6 6 6 6 6 6 6 5 6 6 5 5 5 5 6 5 6 5 6 6 5 5 6 5 6 6 6 6 6 5 6 6 5 5 6 6 6 5 6 6 5 5 5 5 5 5 5 7 6 6 5 7 5 7 5 6 5 6 5 6 5 5 5 6 6 6 7 6 6 5 6 6 5 6 5 6 5 5 5 6 6 5 6 6 6 6 6 5 5 5 5 5 6 6 5 5 6 5 6 5 6 6 5 6 5 6 6 5 6 5 6 5 6 6 6 6 6 6 6 6 6 5 6 6 6 6 5 5 6 5 6 6 5 6 5 5 5 5 5 5 5 6 6 5 5 6 6 6 5 6 5 6 6 6 6 6 6 6 6 5 6 6 6 6 6 5 6 6 6 6 6 6 6 6 6`.split(' ').map(Number),
  quality: `5 8 6 6 6 4 7 6 6 5 6 6 5 7 7 7 6 6 6 5 6 6 6 6 6 5 6 6 7 6 6 7 6 5 6 6 5 7 7 6 5 7 6 7 5 5 5 5 7 6 6 6 6 6 6 6 6 4 7 5 6 6 5 6 5 5 6 5 6 5 4 6 5 7 5 6 6 6 6 6 6 6 7 8 5 7 7 7 5 7 7 6 5 6 6 6 6 6 6 6 6 6 6 6 6 6 5 5 5 7 5 6 5 5 4 6 4 6 6 4 4 5 5 6 5 6 5 5 5 6 6 6 5 5 5 5 5 5 6 6 6 5 4 5 4 6 6 6 6 6 8 6 6 5 5 6 6 4 6 6 7 6 6 6 6 5 5 6 5 5 5 5 6 6 4 6 5 5 6 6 3 6 6 6 5 5 5 5 4 5 5 5 6 5 6 6 6 6 6 6 6 5 6 5 7 6 6 6 6 5 6 6 5 6 5 5 6 5 5 5 6 6 6 6 6 5 6 5 5 5 5 5 6 5 5 5 5 5 6 5 6 5 5 6 4 6 5 5 6 6 4 5 6 5 5 3 5 5 6 6 6 6 5 5 5 5 5 5 5 5 5 6 5 5 5 5 6 5 5 7 6 5 5 6 8 6 7 6 6 7 6 6 6 6 5 5 5 5 7 5 5 5 5 6 4 6 6 6 5 5 5 5 6 6 7 6 6 5 5 5 6 7 6 5 5 6 6 5 5 5 8 7 7 7 5 6 6 6 5 5 7 6 4 6 6 5 5 7 4 7 3 5 5 6 5 5 7 5 7 3 5 4 5 4 5 4 5 5 5 5 6 6 5 5 5 7 6 5 6 6 6 5 5 5 6 6 3 6 6 6 5 6 5 6 6 6 6 5 6 5 5 6 4 5 5 6 5 6 6 6 6 6 5 6 5 7 6 6 6 5 5 6 7 6 6 7 6 5 5 5 8 5 5 6 5 6 7 5 6 5 5 5 5 5 5 5 6 6 5 5 6 6 6 5 6 6 6 6 6 6 5 6 5 5 5 7 6 6 6 6 5 6 6 6 6 5 6 6 5 6`.split(' ').map(Number),
  featureImportance: [
    ['alcohol', 12.997634518065146],
    ['volatile acidity', 10.389218227361603],
    ['density', 10.1915942871989],
    ['total sulfur dioxide', 9.647195793591164],
    ['free sulfur dioxide', 9.198200314699832],
    ['chlorides', 9.039396281173039],
    ['residual sugar', 8.624859483473235],
    ['pH', 7.752088726124005],
    ['citric acid', 7.749746364906198],
    ['sulphates', 7.542615142163307],
    ['fixed acidity', 6.867450861243761]
  ],
  data: RED_WINE_DATA,

}


@Injectable()
export class WineService {

  constructor() {
  }


  public getWineData(wine: string = 'white'): Promise<any> {

    return this.setupData(wine);
  }

  private setupData(wine: string = 'white'): Promise<any> {


    return new Promise((resolve, reject) => {

      const WINE = wine === 'white' ? whiteWine : redWine;

      let count: number = 0;


      const url = `http://archive.ics.uci.edu/ml/machine-learning-databases/wine-quality/winequality-${wine}.csv`;


      const split = .7 * WINE.data.length;

      const testData = WINE.data.slice(0, split);


      const trainData = WINE.data.slice(split).map((i, idx) =>
        Object.assign(i, {quality: Number(i.quality), prediction: Number(WINE.predict[idx])}))


      trainData.map((q, i) => {
        if (q.prediction === WINE.quality[i]) {

          count++;
        }
      });

      const avg = count / WINE.quality.length;

      resolve({
        avg,
        testData,
        trainData,
        url,
        featureImportance: WINE.featureImportance,
      });

    })


  }


}
